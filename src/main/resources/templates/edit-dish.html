<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Dish</title>
    <link href="https://fonts.googleapis.com/css2?family=Irish+Grover&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/edit-dish.css">
</head>
<body>

<header>
    <h1>CookMaster</h1>
    <h2>Edit Dish</h2>
</header>


<form th:action="@{/dish/searching}" method="GET" class="search-box">

    <div class="wrapper-search">
        <div class="box-searching">
            <input type="text" id="search-tab" name="name" placeholder="Search..." required>
        </div>
        <div class="icon-button-wrapper">
            <button type="submit" id="search-btn">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>
</form>


<div class="card" th:if="${dishRequest}">
    <form th:action="@{/dish/update/{id}(id=${dish.id})}" method="post" th:object="${dishRequest}">
        <input type="hidden" name="_method" value="PATCH"/>
        <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
        <input type="hidden" name="id" th:value="${dish.id}"/>

        <label>Dish Name:</label>
        <input type="text" th:field="*{dishName}"/>

        <label>Dish Type:</label>
        <select th:field="*{dishType}">
            <option value="BREAKFAST">Breakfast</option>
            <option value="LUNCH">Lunch</option>
            <option value="DINNER">Dinner</option>
        </select>

        <label>Description:</label>
        <textarea th:field="*{dishDescription}"></textarea>

        <label>Ingredients:</label>
        <input type="text" id="ingredient" placeholder="Enter ingredient">
        <button class="add-btn" type="button" onclick="addIngredient()">+</button>

        <ul id="ingredients-list">
            <li th:each="ingredient : ${dishRequest.ingredients}">
                <span th:text="${ingredient}"></span>
                <input type="hidden" name="ingredients" th:value="${ingredient}"/>
                <button type="button" class="remove-btn" onclick="removeIngredient(this)">X</button>
            </li>
        </ul>
        <div id="save-wrapper-btn">
            <button class="save-btn" type="submit">Save</button>
        </div>

    </form>

    <form id="delete-form" th:action="@{/dish/delete/{id}(id=${dish.id})}" method="post">
        <input type="hidden" name="_method" value="DELETE"/>
        <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
        <button type="submit" class="delete-btn">Delete</button>
    </form>
    <div id="wrapper-shop">
        <button type="button" class="shop-btn" onclick="openModal()">Add to <i class="fas fa-shopping-cart"></i></button>
    </div>

</div>

<script>
    function addIngredient() {
        const input = document.getElementById("ingredient");
        const ingredient = input.value.trim();
        if (ingredient !== "") {
            const list = document.getElementById("ingredients-list");
            const li = document.createElement("li");
            li.innerHTML = `<span>${ingredient}</span>
                            <input type="hidden" name="ingredients" value="${ingredient}"/>
                            <button type="button" class="remove-btn" onclick="removeIngredient(this)">X</button>`;
            list.appendChild(li);
            input.value = "";
        }
    }

    function removeIngredient(button) {
        button.parentElement.remove();
    }

</script>

</body>
</html>
